<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>centos7搭建ss</title>
      <link href="/2019-02-24-centos7%E6%90%AD%E5%BB%BAss.html"/>
      <url>/2019-02-24-centos7%E6%90%AD%E5%BB%BAss.html</url>
      
        <content type="html"><![CDATA[<h1 id="服务搭建"><a href="#服务搭建" class="headerlink" title="服务搭建"></a>服务搭建</h1><ol><li><p>连接上租的vps之后首先要更新一下</p><p><code>yum -y update</code></p></li><li><p>然后安装比较常用的软件</p><p><code>yum -y install wget vim</code></p></li><li><p>进入ssh配置目录修改ssh端口号为不常用的端口号（这里我用的是1996）</p><p><code>vim /etc/ssh/sshd_config</code></p></li><li><p>安装pip</p><p>4.1 先安装依赖</p><p><code>yum -y install epel-release</code></p><p>4.2 安装pip</p><p><code>yum -y install pip python-pip</code></p><p>4.3 更新pip版本</p><p><code>pip install --upgrade pip</code></p></li><li><p>pip安装shadowsocks</p><p><code>pip install shadowsocks</code></p></li><li><p>修改配置文件</p><p><code>vim /etc/shadowsocks.json</code></p><p>单用户内容为</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    &quot;server&quot;:&quot;服务器的IP地址&quot;,</span><br><span class="line">    &quot;server_port&quot;:服务监听的端口号,</span><br><span class="line">    &quot;local_address&quot;: &quot;127.0.0.1&quot;,</span><br><span class="line">    &quot;local_port&quot;:1080,</span><br><span class="line">    &quot;password&quot;:&quot;监听端口密码&quot;,</span><br><span class="line">    &quot;timeout&quot;:300,</span><br><span class="line">    &quot;method&quot;:&quot;rc4-md5&quot;,</span><br><span class="line">    &quot;fast_open&quot;: false</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>多用户内容为</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    &quot;server&quot;:&quot;服务器IP地址&quot;,</span><br><span class="line">    &quot;local_address&quot;:&quot;127.0.0.1&quot;,</span><br><span class="line">    &quot;local_port&quot;:1080,</span><br><span class="line">    &quot;port_password&quot;:&#123;</span><br><span class="line">         &quot;8989&quot;:&quot;password0&quot;,</span><br><span class="line">         &quot;9004&quot;:&quot;password2&quot;</span><br><span class="line">    &#125;,</span><br><span class="line">    &quot;timeout&quot;:300,</span><br><span class="line">    &quot;method&quot;:&quot;rc4-md5&quot;,</span><br><span class="line">    &quot;fast_open&quot;: false</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ol><h1 id="配套软件的安装"><a href="#配套软件的安装" class="headerlink" title="配套软件的安装"></a>配套软件的安装</h1><ol><li><p>运行前安装加密</p><p><code>yum -y install m2crypto</code></p></li><li><p>（可选）安装gevent<br>安装gevent可以提高Shadowsocks的性能。CentOS下安装gevent依赖libevent和greenlet。</p><p>2.1 安装libevent</p><p><code>yum install -y libevent</code></p><p>2.2 安装greenlet</p><p><code>pip install  greenlet</code></p><p>2.3 安装gevent</p><p><code>pip install gevent</code></p></li><li><p>安装破解版锐速</p><p>3.1 首先判断系统版本</p><p><code>uname -r</code></p><p>如果输出结果以2开头，例如2.6.32-696.18.7.el6.x86_64，则为centos6 x64系统。</p><p>如果输出结果以3开头，例如3.10.0-693.11.6.el7.x86_64，则为centos7 x64系统。</p><p>如果输出结果以4开头，例如4.12.10-1.el7.elrepo.x86_64，则说明服务器已经安装Google BBR拥塞控制系统，此时无法继续安装锐速。</p><p>3.2 更新系统内核版本</p><p><code>wget --no-check-certificate -O rskernel.sh https://raw.githubusercontent.com/uxh/shadowsocks_bash/master/rskernel.sh &amp;&amp; bash rskernel.sh</code></p><p>内核更新完毕以后会自动重启。</p><p>3.3 安装锐速</p><p><code>yum install net-tools -y &amp;&amp; wget --no-check-certificate -O appex.sh https://raw.githubusercontent.com/0oVicero0/serverSpeeder_Install/master/appex.sh &amp;&amp; bash appex.sh install</code></p><p>输入以上命令，回车后系统会自动下载脚本并执行。   </p><p>所有设置都直接默认回车继续，即可完成安装。</p><p>当出现以下信息时说明锐速安装成功并开机自启动。   </p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[Running Status]</span><br><span class="line">ServerSpeeder is running!</span><br><span class="line">version     3.11.20.10</span><br></pre></td></tr></table></figure></li></ol><h1 id="shadowsocks服务命令与开机自启动"><a href="#shadowsocks服务命令与开机自启动" class="headerlink" title="shadowsocks服务命令与开机自启动"></a>shadowsocks服务命令与开机自启动</h1><ol><li><p>启动与停止shadowsocks</p><p>启动<code>ssserver -c /etc/shadowsocks.json -d start</code></p><p>停止<code>ssserver -c /etc/shadowsocks.json -d stop</code></p></li><li><p>配置开机启动</p><p>2.1 在/etc/systemd/system/下添加一个shadowsocks服务</p><p><code>vim /etc/systemd/system/shadowsocks.servive</code></p><p><strong>内容见文末</strong></p><p>2.3 启动停止服务</p><p><code>systemctl { status | start | stop | restart } shadowsocks</code></p><p>2.4 添加开机启动服务</p><p><code>systemctl enable shadowsocks</code></p></li><li><p>添加防火墙对应端口的规则（ssh服务和shadowsocks服务开启的端口都需要添加）</p><p><code>firewall-cmd --zone=public --add-port=1996/tcp --permanent</code></p></li><li><p>重启ssh服务和防火墙</p><p><code>systemctl rstart sshd</code><br><code>firewall-cmd --reload</code></p></li></ol><hr><p><strong><em>附</em></strong>：</p><p>/etc/systemd/system/shadowsocks文件内容</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">[Unit]</span><br><span class="line">Description=ssserver</span><br><span class="line">[Service]</span><br><span class="line">TimeoutStartSec=0</span><br><span class="line">ExecStart=/usr/bin/ssserver -c /etc/shadowsocks.json</span><br><span class="line">[Install]</span><br><span class="line">WantedBy=multi-user.target</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 日志 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 建站 </tag>
            
            <tag> centos </tag>
            
            <tag> shadowsocks </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>centos6搭建ss</title>
      <link href="/2019-02-24-centos6%E6%90%AD%E5%BB%BAss.html"/>
      <url>/2019-02-24-centos6%E6%90%AD%E5%BB%BAss.html</url>
      
        <content type="html"><![CDATA[<h1 id="服务搭建"><a href="#服务搭建" class="headerlink" title="服务搭建"></a>服务搭建</h1><ol><li><p>连接上租的vps之后首先要更新一下</p><p><code>yum -y update</code></p></li><li><p>然后安装比较常用的软件</p><p><code>yum -y install wget vim</code></p></li><li><p>进入ssh配置目录修改ssh端口号为不常用的端口号（这里我用的是1996）</p><p><code>vim /etc/ssh/sshd_config</code></p></li><li><p>更新python版本（由于默认安装的是python2.6版本，需要先升级为2.7版本）</p><p>4.1 先安装依赖</p><p><code>yum -y install gcc openssl-devel bzip2-devel</code></p><p>4.2 下载软件包</p><p><code>cd /opt &amp;&amp; wget https://www.python.org/ftp/python/2.7.15/Python-2.7.15.tgz</code></p><p>4.3 解压</p><p><code>tar xvzf Python-2.7.15.tgz</code></p><p>4.4 进入目录安装（在检测脚本中加上enable-optimizations优化，主要是在这个版本上能启用PGO优化，让Python在运行时能变得更快。make 加altinstall参数，避免覆盖原来安装在/usr/bin/python 的版本。）</p><p><code>cd Python-2.7.15</code><br><code>./configure --enable-optimizations</code><br><code>make &amp;&amp; make altinstall</code></p><p>4.5 查看是否安装成功</p><p><code>/usr/local/bin/python2.7 -V</code></p></li></ol><p>返回2.7.15则成功，继续进行下一步<br> 4.6 建立软链接，使系统默认python指向2.7版本</p><p> <code>mv /usr/bin/python /usr/bin/python2.6.6</code>   (备份原来的2.6版本的python)<br> <code>ln -s /usr/local/bin/python2.7 /usr/bin/python</code></p><p> 4.7 解决yum不支持2.7版本的问题</p><p> <code>sed -i &#39;s/python/python2.6.6/&#39; /usr/bin/yum</code></p><ol start="5"><li><p>安装pip（因为2.7.15版本已经内建了ensurepip模块，所以直接运行下面的命令去安装pip即可）默认安装的pip为9版本，你需要再升级一下pip版本</p><p><code>python -m ensurepip</code><br><code>pip install --upgrade pip</code></p></li><li><p>pip安装shadowsocks</p><p><code>pip install shadowsocks</code></p></li><li><p>修改配置文件</p><p><code>vim /etc/shadowsocks.json</code></p><p>单用户内容为</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    &quot;server&quot;:&quot;服务器的IP地址&quot;,</span><br><span class="line">    &quot;server_port&quot;:服务监听的端口号,</span><br><span class="line">    &quot;local_address&quot;: &quot;127.0.0.1&quot;,</span><br><span class="line">    &quot;local_port&quot;:1080,</span><br><span class="line">    &quot;password&quot;:&quot;监听端口密码&quot;,</span><br><span class="line">    &quot;timeout&quot;:300,</span><br><span class="line">    &quot;method&quot;:&quot;rc4-md5&quot;,</span><br><span class="line">    &quot;fast_open&quot;: false</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>多用户内容为</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    &quot;server&quot;:&quot;服务器IP地址&quot;,</span><br><span class="line">    &quot;local_address&quot;:&quot;127.0.0.1&quot;,</span><br><span class="line">    &quot;local_port&quot;:1080,</span><br><span class="line">    &quot;port_password&quot;:&#123;</span><br><span class="line">         &quot;8989&quot;:&quot;password0&quot;,</span><br><span class="line">         &quot;9004&quot;:&quot;password2&quot;</span><br><span class="line">    &#125;,</span><br><span class="line">    &quot;timeout&quot;:300,</span><br><span class="line">    &quot;method&quot;:&quot;rc4-md5&quot;,</span><br><span class="line">    &quot;fast_open&quot;: false</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ol><h1 id="配套软件的安装"><a href="#配套软件的安装" class="headerlink" title="配套软件的安装"></a>配套软件的安装</h1><ol><li><p>运行前安装加密</p><p><code>yum -y install m2crypto</code></p></li><li><p>（可选）安装gevent<br>安装gevent可以提高Shadowsocks的性能。CentOS下安装gevent依赖libevent和greenlet。</p><p>2.1 安装libevent</p><p><code>yum install -y libevent</code></p><p>2.2 安装greenlet</p><p><code>pip install  greenlet</code></p><p>2.3 安装gevent</p><p><code>pip install gevent</code></p></li><li><p>安装破解版锐速</p><p>3.1 首先判断系统版本</p><p><code>uname -r</code></p><p>如果输出结果以2开头，例如2.6.32-696.18.7.el6.x86_64，则为centos6 x64系统。</p><p>如果输出结果以3开头，例如3.10.0-693.11.6.el7.x86_64，则为centos7 x64系统。</p><p>如果输出结果以4开头，例如4.12.10-1.el7.elrepo.x86_64，则说明服务器已经安装Google BBR拥塞控制系统，此时无法继续安装锐速。</p><p>3.2 安装锐速</p><p><code>wget --no-check-certificate -O appex.sh https://raw.githubusercontent.com/0oVicero0/serverSpeeder_Install/master/appex.sh &amp;&amp; bash appex.sh install &#39;2.6.32-642.el6.x86_64&#39;</code></p><p>输入以上命令，回车后系统会自动下载脚本并执行。   </p><p>所有设置都直接默认回车继续，即可完成安装。</p><p>当出现以下信息时说明锐速安装成功并开机自启动。   </p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[Running Status]</span><br><span class="line">ServerSpeeder is running!</span><br><span class="line">version     3.11.20.10</span><br></pre></td></tr></table></figure></li></ol><h1 id="shadowsocks服务命令与开机自启动"><a href="#shadowsocks服务命令与开机自启动" class="headerlink" title="shadowsocks服务命令与开机自启动"></a>shadowsocks服务命令与开机自启动</h1><ol><li><p>启动与停止shadowsocks</p><p>启动<code>ssserver -c /etc/shadowsocks.json -d start</code></p><p>停止<code>ssserver -c /etc/shadowsocks.json -d stop</code></p></li><li><p>配置开机启动</p><p>2.1 在/etc/init.d/下添加一个shadowsocks服务</p><p><code>vim /etc/init.d/shadowsocks</code></p><p><strong>内容见文末</strong></p><p>2.2 添加执行权限</p><p><code>chmod +x /etc/init.d/shadowsocks</code></p><p>2.3 启动停止服务</p><p><code>services shadowsocks { status | start | stop | restart }</code></p><p>2.4 添加开机启动服务</p><p><code>chkconfig --add shadowsocks</code><br><code>chkconfig --list shadowsocks</code></p><p>输出shadowsocks     0:off   1:off   2:on    3:on    4:on    5:on    6:off即为成功。</p></li><li><p>关闭防火墙，并关闭防火墙自启动</p><p><code>service iptables stop</code><br><code>chkconfig iptables off</code><br><code>chkconfig --list iptables</code><br>（检查防火墙是否关闭自启动iptables        0:off   1:off   2:off   3:off   4:off   5:off   6:off）</p></li><li><p>重启ssh服务</p><p><code>service sshd restart</code></p></li></ol><hr><p><strong><em>附</em></strong>：</p><p>/etc/init.d/shadowsocks文件内容</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><span class="line">#!/bin/sh</span><br><span class="line"># chkconfig: 2345 90 10</span><br><span class="line"># description: Start or stop the Shadowsocks server</span><br><span class="line">#</span><br><span class="line">### BEGIN INIT INFO</span><br><span class="line"># Provides: Shadowsocks</span><br><span class="line"># Required-Start: $network $syslog</span><br><span class="line"># Required-Stop: $network</span><br><span class="line"># Default-Start: 2 3 4 5</span><br><span class="line"># Default-Stop: 0 1 6</span><br><span class="line"># Description: Start or stop the Shadowsocks server</span><br><span class="line">### END INIT INFO</span><br><span class="line"># Author: xju &lt;qing0991@163.com&gt;</span><br><span class="line">name=shadowsocks</span><br><span class="line">BIN=/usr/local/bin/ssserver</span><br><span class="line">conf=/etc/shadowsocks.json</span><br><span class="line">start()&#123;</span><br><span class="line">    $BIN -c $conf -d start</span><br><span class="line">    RETVAL=$?</span><br><span class="line">    if [ &quot;$RETVAL&quot; = &quot;0&quot; ]; then</span><br><span class="line">        echo &quot;$name start success&quot;</span><br><span class="line">    else</span><br><span class="line">        echo &quot;$name start failed&quot;</span><br><span class="line">    fi</span><br><span class="line">&#125;</span><br><span class="line">stop()&#123;</span><br><span class="line">    pid=`ps -ef | grep -v grep | grep -v ps | grep -i &quot;$&#123;BIN&#125;&quot; | awk &apos;&#123;print $2&#125;&apos;`</span><br><span class="line">    if [ ! -z $pid ]; then</span><br><span class="line">        $BIN -c $conf -d stop</span><br><span class="line">        RETVAL=$?</span><br><span class="line">        if [ &quot;$RETVAL&quot; = &quot;0&quot; ]; then</span><br><span class="line">            echo &quot;$name stop success&quot;</span><br><span class="line">        else</span><br><span class="line">            echo &quot;$name stop failed&quot;</span><br><span class="line">        fi</span><br><span class="line">    else</span><br><span class="line">        echo &quot;$name is not running&quot;</span><br><span class="line">        RETVAL=1</span><br><span class="line">    fi</span><br><span class="line">&#125;</span><br><span class="line">status()&#123;</span><br><span class="line">    pid=`ps -ef | grep -v grep | grep -v ps | grep -i &quot;$&#123;BIN&#125;&quot; | awk &apos;&#123;print $2&#125;&apos;`</span><br><span class="line">    if [ -z $pid ]; then</span><br><span class="line">        echo &quot;$name is not running&quot;</span><br><span class="line">        RETVAL=1</span><br><span class="line">    else</span><br><span class="line">        echo &quot;$name is running with PID $pid&quot;</span><br><span class="line">        RETVAL=0</span><br><span class="line">    fi</span><br><span class="line">&#125;</span><br><span class="line">case &quot;$1&quot; in</span><br><span class="line">&apos;start&apos;)</span><br><span class="line">    start</span><br><span class="line">    ;;</span><br><span class="line">&apos;stop&apos;)</span><br><span class="line">    stop</span><br><span class="line">    ;;</span><br><span class="line">&apos;status&apos;)</span><br><span class="line">    status</span><br><span class="line">    ;;</span><br><span class="line">&apos;restart&apos;)</span><br><span class="line">    stop</span><br><span class="line">    start</span><br><span class="line">    RETVAL=$?</span><br><span class="line">    ;;</span><br><span class="line">*)</span><br><span class="line">    echo &quot;Usage: $0 &#123; start | stop | restart | status &#125;&quot;</span><br><span class="line">    RETVAL=1</span><br><span class="line">    ;;</span><br><span class="line">esac</span><br><span class="line">exit $RETVAL</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 日志 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 建站 </tag>
            
            <tag> shadowsocks </tag>
            
            <tag> centos6 </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
